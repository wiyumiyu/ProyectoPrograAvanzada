@model AlquilerCreateVM

<h2>Nuevo Alquiler</h2>

<form asp-action="Create">

    <label>Cliente:</label>
    <select asp-for="IdCliente" class="form-control">
        @foreach (var c in ViewBag.Clientes)
        {
            <option value="@c.IdCliente">@c.Nombre</option>
        }
    </select>

    <label>Empleado:</label>
    <select asp-for="IdEmpleado" class="form-control">
        @foreach (var e in ViewBag.Empleados)
        {
            <option value="@e.IdEmpleado">@e.Nombre</option>
        }
    </select>

    <label>Sucursal:</label>
    <select asp-for="IdSucursal" class="form-control">
        @foreach (var s in ViewBag.Sucursales)
        {
            <option value="@s.IdSucursal">@s.Nombre</option>
        }
    </select>

    <hr />

    <h3>Agregar Vehículos</h3>

    <div id="detalles-container"></div>

    <button type="button" class="btn btn-secondary" onclick="agregarDetalle()">Agregar Vehículo</button>

    <hr />

    <button class="btn btn-primary">Guardar</button>
</form>

@section Scripts {
    <script>
        function agregarDetalle() {
            let html = `
                <div class="detalle-item border p-2 my-2">
                    <select name="Detalles[index].IdVehiculo" class="form-control">
                        @foreach (var v in ViewBag.Vehiculos)
                        {
                                <option value="@v.IdVehiculo">@v.Placa - @v.Marca</option>
                        }
                    </select>

                    <input type="number" step="0.01" name="Detalles[index].TarifaDiaria" placeholder="Tarifa diaria" class="form-control" />

                    <label>Fecha inicio</label>
                    <input type="date" name="Detalles[index].FechaInicio" class="form-control" />

                    <label>Fecha fin</label>
                    <input type="date" name="Detalles[index].FechaFin" class="form-control" />
                </div>
            `;

            let cont = document.getElementById("detalles-container");
            let index = document.getElementsByClassName("detalle-item").length;

            html = html.replace(/index/g, index);

            cont.insertAdjacentHTML("beforeend", html);
        }
    </script>
}

